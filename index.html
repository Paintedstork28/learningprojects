<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookFinder Pro - AI-Powered Book Recommendations</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .navigation {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
        }

        .main-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 1.1rem;
        }

        .input-container {
            position: relative;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .autocomplete-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }

        .autocomplete-item:hover {
            background-color: #f8f9fa;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .genre-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .genre-tag {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .genre-tag .remove {
            cursor: pointer;
            font-weight: bold;
        }

        .genre-select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1rem;
            background: #f8f9fa;
            cursor: pointer;
        }

        .textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1rem;
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
            background: #f8f9fa;
            transition: all 0.3s ease;
        }

        .textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            display: none;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
        }

        .results h2 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2rem;
        }

        .book-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            transition: transform 0.2s ease;
        }

        .book-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .book-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .book-author {
            color: #666;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .book-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .book-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .stars {
            color: #ffc107;
        }

        .rating-text {
            color: #666;
            font-size: 0.9rem;
        }

        .book-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .book-link {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: background-color 0.2s;
        }

        .book-link:hover {
            background: #5a6fd8;
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #c33;
        }

        .success-message {
            background: #efe;
            color: #363;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #363;
        }

        .validation-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .validation-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .validation-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .validation-loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .source-badge {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .search-progress {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
            display: none;
        }

        .progress-step {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }

        .progress-step.completed {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
        }

        .step-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 0.9rem;
        }

        .step-icon.pending {
            background: #e0e0e0;
            color: #666;
        }

        .step-icon.active {
            background: #2196f3;
            color: white;
        }

        .step-icon.completed {
            background: #4caf50;
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .main-card, .results {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .book-links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-book-open"></i> BookFinder Pro</h1>
            <p>AI-Powered Book Recommendations from Multiple Sources</p>
        </div>

        <nav class="navigation">
            <a href="index.html" class="nav-link active">
                <i class="fas fa-home"></i> Home
            </a>
            <a href="about.html" class="nav-link">
                <i class="fas fa-user"></i> About
            </a>
        </nav>

        <div class="main-card">
            <form id="bookForm">
                <div class="form-group">
                    <label for="bookTitle">Book Title *</label>
                    <div class="input-container">
                        <input type="text" id="bookTitle" class="form-input" placeholder="Enter the book title..." required>
                        <div id="titleAutocomplete" class="autocomplete-dropdown"></div>
                    </div>
                    <div id="titleValidation" class="validation-status" style="display: none;"></div>
                </div>

                <div class="form-group">
                    <label for="author">Author</label>
                    <div class="input-container">
                        <input type="text" id="author" class="form-input" placeholder="Author will be auto-filled or enter manually...">
                        <div id="authorAutocomplete" class="autocomplete-dropdown"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="genre">Genres</label>
                    <select id="genreSelect" class="genre-select">
                        <option value="">Select a genre to add...</option>
                        <option value="fantasy">Fantasy</option>
                        <option value="romance">Romance</option>
                        <option value="science-fiction">Science Fiction</option>
                        <option value="horror">Horror</option>
                        <option value="adventure">Adventure</option>
                        <option value="slice-of-life">Slice of Life</option>
                        <option value="biography">Biography</option>
                        <option value="sports">Sports</option>
                        <option value="mystery">Mystery</option>
                        <option value="thriller">Thriller</option>
                        <option value="historical-fiction">Historical Fiction</option>
                        <option value="literary-fiction">Literary Fiction</option>
                        <option value="young-adult">Young Adult</option>
                        <option value="children">Children's</option>
                        <option value="non-fiction">Non-Fiction</option>
                        <option value="self-help">Self-Help</option>
                        <option value="business">Business</option>
                        <option value="philosophy">Philosophy</option>
                        <option value="poetry">Poetry</option>
                    </select>
                    <div id="selectedGenres" class="genre-container"></div>
                </div>

                <div class="form-group">
                    <label for="additionalPreferences">Additional Preferences</label>
                    <textarea id="additionalPreferences" class="textarea" placeholder="Tell us more about what you're looking for... (e.g., 'similar but with more romance', 'darker tone', 'younger protagonist', etc.)"></textarea>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <i class="fas fa-search"></i> Find Similar Books
                </button>
            </form>
        </div>

        <div id="searchProgress" class="search-progress">
            <h3><i class="fas fa-cog fa-spin"></i> Searching Multiple Sources...</h3>
            <div class="progress-step" id="step1">
                <div class="step-icon pending">1</div>
                <div>Validating book information...</div>
            </div>
            <div class="progress-step" id="step2">
                <div class="step-icon pending">2</div>
                <div>Searching Goodreads for similar books...</div>
            </div>
            <div class="progress-step" id="step3">
                <div class="step-icon pending">3</div>
                <div>Analyzing web sources and reviews...</div>
            </div>
            <div class="progress-step" id="step4">
                <div class="step-icon pending">4</div>
                <div>Checking Reddit recommendations...</div>
            </div>
            <div class="progress-step" id="step5">
                <div class="step-icon pending">5</div>
                <div>Generating personalized recommendations...</div>
            </div>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Finalizing your personalized book recommendations...</p>
        </div>

        <div id="results" class="results">
            <h2><i class="fas fa-star"></i> Your Personalized Recommendations</h2>
            <div id="bookList"></div>
        </div>
    </div>

    <script>
        class BookRecommenderPro {
            constructor() {
                this.selectedGenres = [];
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                // Book title autocomplete
                const bookTitleInput = document.getElementById('bookTitle');
                bookTitleInput.addEventListener('input', this.debounce(this.handleTitleInput.bind(this), 300));
                bookTitleInput.addEventListener('blur', () => {
                    setTimeout(() => this.hideAutocomplete('titleAutocomplete'), 200);
                });

                // Author autocomplete
                const authorInput = document.getElementById('author');
                authorInput.addEventListener('input', this.debounce(this.handleAuthorInput.bind(this), 300));
                authorInput.addEventListener('blur', () => {
                    setTimeout(() => this.hideAutocomplete('authorAutocomplete'), 200);
                });

                // Genre selection
                const genreSelect = document.getElementById('genreSelect');
                genreSelect.addEventListener('change', this.handleGenreSelection.bind(this));

                // Form submission
                document.getElementById('bookForm').addEventListener('submit', this.handleFormSubmission.bind(this));
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            async handleTitleInput(event) {
                const query = event.target.value.trim();
                if (query.length < 2) {
                    this.hideAutocomplete('titleAutocomplete');
                    return;
                }

                try {
                    const suggestions = await this.searchBookTitles(query);
                    this.showAutocomplete('titleAutocomplete', suggestions, (suggestion) => {
                        document.getElementById('bookTitle').value = suggestion.title;
                        document.getElementById('author').value = suggestion.author || '';
                        this.hideAutocomplete('titleAutocomplete');
                        this.validateBook(suggestion.title, suggestion.author);
                    });
                } catch (error) {
                    console.error('Error fetching title suggestions:', error);
                }
            }

            async handleAuthorInput(event) {
                const query = event.target.value.trim();
                if (query.length < 2) {
                    this.hideAutocomplete('authorAutocomplete');
                    return;
                }

                try {
                    const suggestions = await this.searchAuthors(query);
                    this.showAutocomplete('authorAutocomplete', suggestions, (suggestion) => {
                        document.getElementById('author').value = suggestion;
                        this.hideAutocomplete('authorAutocomplete');
                    });
                } catch (error) {
                    console.error('Error fetching author suggestions:', error);
                }
            }

            handleGenreSelection(event) {
                const selectedGenre = event.target.value;
                if (selectedGenre && !this.selectedGenres.includes(selectedGenre)) {
                    this.selectedGenres.push(selectedGenre);
                    this.updateGenreDisplay();
                }
                event.target.value = '';
            }

            updateGenreDisplay() {
                const container = document.getElementById('selectedGenres');
                container.innerHTML = this.selectedGenres.map(genre => `
                    <div class="genre-tag">
                        ${genre.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                        <span class="remove" onclick="bookRecommender.removeGenre('${genre}')">&times;</span>
                    </div>
                `).join('');
            }

            removeGenre(genre) {
                this.selectedGenres = this.selectedGenres.filter(g => g !== genre);
                this.updateGenreDisplay();
            }

            async validateBook(title, author) {
                const validationDiv = document.getElementById('titleValidation');
                validationDiv.style.display = 'block';
                validationDiv.className = 'validation-status validation-loading';
                validationDiv.textContent = 'Validating book...';

                try {
                    const bookData = await this.checkBookExists(title, author);
                    if (bookData.found) {
                        validationDiv.className = 'validation-status validation-success';
                        validationDiv.textContent = `✓ Book found: "${bookData.title}" by ${bookData.author}`;
                    } else {
                        validationDiv.className = 'validation-status validation-error';
                        validationDiv.textContent = '⚠ Book not found. You can still proceed to get recommendations.';
                    }
                } catch (error) {
                    validationDiv.className = 'validation-status validation-error';
                    validationDiv.textContent = 'Error validating book. You can still proceed.';
                }
            }

            async handleFormSubmission(event) {
                event.preventDefault();
                
                const bookTitle = document.getElementById('bookTitle').value.trim();
                const author = document.getElementById('author').value.trim();
                const additionalPreferences = document.getElementById('additionalPreferences').value.trim();

                if (!bookTitle) {
                    this.showError('Please enter a book title.');
                    return;
                }

                this.showSearchProgress();
                
                try {
                    const recommendations = await this.getComprehensiveRecommendations({
                        title: bookTitle,
                        author: author,
                        genres: this.selectedGenres,
                        preferences: additionalPreferences
                    });
                    
                    this.displayResults(recommendations);
                } catch (error) {
                    this.showError('Failed to get recommendations. Please try again.');
                    console.error('Error getting recommendations:', error);
                } finally {
                    this.hideSearchProgress();
                }
            }

            async searchBookTitles(query) {
                // Enhanced book search with more comprehensive results
                const mockSuggestions = [
                    { title: "Harry Potter and the Goblet of Fire", author: "J.K. Rowling" },
                    { title: "The Great Gatsby", author: "F. Scott Fitzgerald" },
                    { title: "To Kill a Mockingbird", author: "Harper Lee" },
                    { title: "1984", author: "George Orwell" },
                    { title: "Pride and Prejudice", author: "Jane Austen" },
                    { title: "The Lord of the Rings", author: "J.R.R. Tolkien" },
                    { title: "Dune", author: "Frank Herbert" },
                    { title: "The Handmaid's Tale", author: "Margaret Atwood" },
                    { title: "The Catcher in the Rye", author: "J.D. Salinger" },
                    { title: "The Hobbit", author: "J.R.R. Tolkien" }
                ];
                
                return mockSuggestions.filter(book => 
                    book.title.toLowerCase().includes(query.toLowerCase())
                );
            }

            async searchAuthors(query) {
                const mockAuthors = [
                    "J.K. Rowling", "Stephen King", "George R.R. Martin", 
                    "Agatha Christie", "Isaac Asimov", "Toni Morrison",
                    "Brandon Sanderson", "Neil Gaiman", "Ursula K. Le Guin",
                    "Ray Bradbury", "Octavia Butler", "Terry Pratchett"
                ];
                
                return mockAuthors.filter(author => 
                    author.toLowerCase().includes(query.toLowerCase())
                );
            }

            async checkBookExists(title, author) {
                // Simulate comprehensive book validation
                return new Promise(resolve => {
                    setTimeout(() => {
                        const mockBookData = {
                            found: Math.random() > 0.2,
                            title: title,
                            author: author || "Unknown Author",
                            isbn: "978-0-123456-78-9",
                            publishedYear: "2020"
                        };
                        resolve(mockBookData);
                    }, 1000);
                });
            }

            async getComprehensiveRecommendations(params) {
                // Simulate comprehensive search across multiple sources
                return new Promise(async (resolve) => {
                    // Step 1: Validate book
                    await this.updateProgressStep(1, 'completed');
                    await this.delay(500);

                    // Step 2: Search Goodreads
                    await this.updateProgressStep(2, 'active');
                    await this.delay(1000);
                    await this.updateProgressStep(2, 'completed');

                    // Step 3: Analyze web sources
                    await this.updateProgressStep(3, 'active');
                    await this.delay(1000);
                    await this.updateProgressStep(3, 'completed');

                    // Step 4: Check Reddit
                    await this.updateProgressStep(4, 'active');
                    await this.delay(1000);
                    await this.updateProgressStep(4, 'completed');

                    // Step 5: Generate recommendations
                    await this.updateProgressStep(5, 'active');
                    await this.delay(1000);
                    await this.updateProgressStep(5, 'completed');

                    // Return comprehensive recommendations
                    const recommendations = [
                        {
                            title: "The Name of the Wind",
                            author: "Patrick Rothfuss",
                            description: "A fantasy novel about Kvothe, a legendary figure who tells his own story. Rich in magic, music, and adventure. This book shares the magical school setting and coming-of-age themes with Harry Potter.",
                            rating: 4.5,
                            ratingCount: 125000,
                            goodreadsUrl: "https://www.goodreads.com/book/show/186074.The_Name_of_the_Wind",
                            amazonUrl: "https://www.amazon.com/Name-Wind-Patrick-Rothfuss/dp/0756404746",
                            sources: ["Goodreads", "Reddit", "Web Reviews"]
                        },
                        {
                            title: "Mistborn: The Final Empire",
                            author: "Brandon Sanderson",
                            description: "A fantasy novel set in a world where the Dark Lord has won. Follow Vin as she discovers her powers and joins a crew of thieves. Features a strong female protagonist and magical system similar to Harry Potter's world-building.",
                            rating: 4.4,
                            ratingCount: 98000,
                            goodreadsUrl: "https://www.goodreads.com/book/show/68428.The_Final_Empire",
                            amazonUrl: "https://www.amazon.com/Mistborn-Final-Empire-Brandon-Sanderson/dp/076531178X",
                            sources: ["Goodreads", "Web Reviews"]
                        },
                        {
                            title: "The Lies of Locke Lamora",
                            author: "Scott Lynch",
                            description: "A fantasy heist novel following Locke Lamora and his band of thieves as they pull off elaborate cons in the city of Camorr. Shares the friendship dynamics and adventure elements of Harry Potter.",
                            rating: 4.3,
                            ratingCount: 87000,
                            goodreadsUrl: "https://www.goodreads.com/book/show/29588376-the-lies-of-locke-lamora",
                            amazonUrl: "https://www.amazon.com/Lies-Locke-Lamora-Scott-Lynch/dp/055358894X",
                            sources: ["Reddit", "Web Reviews"]
                        },
                        {
                            title: "The Way of Kings",
                            author: "Brandon Sanderson",
                            description: "An epic fantasy novel set in the world of Roshar, following multiple characters in a world of magic, politics, and war. Features complex world-building and magical systems that fantasy readers will love.",
                            rating: 4.6,
                            ratingCount: 156000,
                            goodreadsUrl: "https://www.goodreads.com/book/show/7235533-the-way-of-kings",
                            amazonUrl: "https://www.amazon.com/Way-Kings-Brandon-Sanderson/dp/0765326353",
                            sources: ["Goodreads", "Reddit", "Web Reviews"]
                        },
                        {
                            title: "The Poppy War",
                            author: "R.F. Kuang",
                            description: "A fantasy novel inspired by Chinese history, following Rin as she discovers her shamanic powers during a brutal war. Features a magical school setting and coming-of-age themes similar to Harry Potter.",
                            rating: 4.2,
                            ratingCount: 67000,
                            goodreadsUrl: "https://www.goodreads.com/book/show/35068705-the-poppy-war",
                            amazonUrl: "https://www.amazon.com/Poppy-War-R-F-Kuang/dp/0062662560",
                            sources: ["Goodreads", "Reddit"]
                        },
                        {
                            title: "Six of Crows",
                            author: "Leigh Bardugo",
                            description: "A fantasy heist novel following six dangerous outcasts as they attempt an impossible heist. Features diverse characters, magical elements, and the friendship dynamics that made Harry Potter beloved.",
                            rating: 4.4,
                            ratingCount: 89000,
                            goodreadsUrl: "https://www.goodreads.com/book/show/23437156-six-of-crows",
                            amazonUrl: "https://www.amazon.com/Six-Crows-Leigh-Bardugo/dp/1627792120",
                            sources: ["Goodreads", "Web Reviews"]
                        }
                    ];

                    resolve(recommendations);
                });
            }

            async updateProgressStep(stepNumber, status) {
                const step = document.getElementById(`step${stepNumber}`);
                const icon = step.querySelector('.step-icon');
                
                step.className = `progress-step ${status}`;
                icon.className = `step-icon ${status}`;
                
                if (status === 'active') {
                    icon.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                } else if (status === 'completed') {
                    icon.innerHTML = '<i class="fas fa-check"></i>';
                }
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            showAutocomplete(containerId, suggestions, onSelect) {
                const container = document.getElementById(containerId);
                if (suggestions.length === 0) {
                    container.style.display = 'none';
                    return;
                }

                container.innerHTML = suggestions.map(suggestion => {
                    const text = typeof suggestion === 'string' ? suggestion : suggestion.title;
                    return `<div class="autocomplete-item" onclick="bookRecommender.selectAutocomplete('${containerId}', '${text.replace(/'/g, "\\'")}')">${text}</div>`;
                }).join('');

                container.style.display = 'block';
                container.onSelect = onSelect;
            }

            selectAutocomplete(containerId, text) {
                const container = document.getElementById(containerId);
                if (container.onSelect) {
                    container.onSelect({ title: text });
                }
                container.style.display = 'none';
            }

            hideAutocomplete(containerId) {
                document.getElementById(containerId).style.display = 'none';
            }

            showSearchProgress() {
                document.getElementById('searchProgress').style.display = 'block';
                document.getElementById('results').style.display = 'none';
                document.getElementById('submitBtn').disabled = true;
            }

            hideSearchProgress() {
                document.getElementById('searchProgress').style.display = 'none';
                document.getElementById('submitBtn').disabled = false;
            }

            displayResults(recommendations) {
                const resultsDiv = document.getElementById('results');
                const bookListDiv = document.getElementById('bookList');

                bookListDiv.innerHTML = recommendations.map(book => `
                    <div class="book-card">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">by ${book.author}</div>
                        <div class="book-rating">
                            <div class="stars">
                                ${'★'.repeat(Math.floor(book.rating))}${'☆'.repeat(5 - Math.floor(book.rating))}
                            </div>
                            <span class="rating-text">${book.rating} (${book.ratingCount.toLocaleString()} ratings)</span>
                        </div>
                        <div class="book-description">${book.description}</div>
                        <div class="book-links">
                            <a href="${book.goodreadsUrl}" target="_blank" class="book-link">
                                <i class="fas fa-book"></i> View on Goodreads
                            </a>
                            <a href="${book.amazonUrl}" target="_blank" class="book-link">
                                <i class="fas fa-shopping-cart"></i> Buy on Amazon
                            </a>
                            ${book.sources.map(source => `<span class="source-badge">${source}</span>`).join('')}
                        </div>
                    </div>
                `).join('');

                resultsDiv.style.display = 'block';
                resultsDiv.scrollIntoView({ behavior: 'smooth' });
            }

            showError(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = message;
                
                const mainCard = document.querySelector('.main-card');
                mainCard.insertBefore(errorDiv, mainCard.firstChild);
                
                setTimeout(() => {
                    errorDiv.remove();
                }, 5000);
            }
        }

        // Initialize the application
        const bookRecommender = new BookRecommenderPro();
    </script>
</body>
</html>
